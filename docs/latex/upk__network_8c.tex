\section{libupkeeper/upkeeper/upk\_\-network.c File Reference}
\label{upk__network_8c}\index{libupkeeper/upkeeper/upk\_\-network.c@{libupkeeper/upkeeper/upk\_\-network.c}}
{\ttfamily \#include \char`\"{}upk\_\-include.h\char`\"{}}\par
Include dependency graph for upk\_\-network.c:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=400pt]{upk__network_8c__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void {\bf upk\_\-call\_\-received\_\-packet\_\-callbacks} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles, {\bf upk\_\-packet\_\-t} $\ast$pkt)
\begin{DoxyCompactList}\small\item\em call callback for received packet based on type. \end{DoxyCompactList}\item 
static int {\bf upk\_\-build\_\-fd\_\-sets} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles, {\bf fd\_\-set} $\ast$readfds, {\bf fd\_\-set} $\ast$writefds, {\bf fd\_\-set} $\ast$exceptfds)
\begin{DoxyCompactList}\small\item\em initialize file-\/descriptor sets \end{DoxyCompactList}\item 
static void {\bf upk\_\-partitioned\_\-userdata\_\-free} (void $\ast$ptr)
\begin{DoxyCompactList}\small\item\em userdata cleanup callback \end{DoxyCompactList}\item 
{\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$ {\bf upk\_\-net\_\-conn\_\-handles\_\-init} (void $\ast$userdata, void($\ast$userdata\_\-free\_\-func)(void $\ast$ptr))
\begin{DoxyCompactList}\small\item\em initialize connection handles \end{DoxyCompactList}\item 
{\bf upk\_\-net\_\-state\_\-t} $\ast$ {\bf upk\_\-net\_\-get\_\-global\_\-state} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles)
\begin{DoxyCompactList}\small\item\em extract the nested global\_\-state component from the generic (void $\ast$) userdata element \end{DoxyCompactList}\item 
void $\ast$ {\bf upk\_\-net\_\-get\_\-global\_\-userdata} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles)
\begin{DoxyCompactList}\small\item\em extract nested the global\_\-userdata component from the generic (void $\ast$) userdata element \end{DoxyCompactList}\item 
bool {\bf upk\_\-net\_\-add\_\-socket\_\-handle} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles, int fd)
\begin{DoxyCompactList}\small\item\em add a new socket handle to the handles list \end{DoxyCompactList}\item 
void {\bf upk\_\-net\_\-flush\_\-closed\_\-sockets} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles)
\begin{DoxyCompactList}\small\item\em iterate through the list of handles, and prune any that are no longer valid. \end{DoxyCompactList}\item 
void {\bf upk\_\-net\_\-event\_\-dispatcher} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles, double sel\_\-ival)
\begin{DoxyCompactList}\small\item\em The event dispatcher, called via an event-\/loop. \end{DoxyCompactList}\item 
int {\bf upk\_\-net\_\-block\_\-until\_\-msg} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles, double sel\_\-ival, struct {\bf timeval} $\ast${\bf timeout})
\begin{DoxyCompactList}\small\item\em block until a complete message is received, up to timeout. \end{DoxyCompactList}\item 
void {\bf upk\_\-disconnect\_\-handle} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles)
\begin{DoxyCompactList}\small\item\em disconnect the -\/$>$thisp handle in handles. \end{DoxyCompactList}\item 
void {\bf upk\_\-net\_\-shutdown\_\-callback} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles, {\bf upk\_\-payload\_\-t} $\ast$msg)
\begin{DoxyCompactList}\small\item\em wrapper around upk-\/disconnect\_\-handle for use as a callback. \end{DoxyCompactList}\item 
void {\bf upk\_\-queue\_\-packet} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles, {\bf upk\_\-conn\_\-handle\_\-t} $\ast$handle, {\bf upk\_\-packet\_\-t} $\ast$pkt, {\bf upk\_\-net\_\-callback\_\-t} after\_\-write\_\-callback)
\begin{DoxyCompactList}\small\item\em enqueue a packet for sending \end{DoxyCompactList}\item 
void {\bf upk\_\-write\_\-packets} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles)
\begin{DoxyCompactList}\small\item\em write the packets in the writeq for handles-\/$>$thisp, and call any write callbacks \end{DoxyCompactList}\item 
void {\bf upk\_\-read\_\-packets} ({\bf upk\_\-conn\_\-handle\_\-meta\_\-t} $\ast$handles)
\begin{DoxyCompactList}\small\item\em read any packets from the handle handles-\/$>$thisp, and call read-\/callbacks. \end{DoxyCompactList}\item 
int {\bf upk\_\-domain\_\-socket\_\-connect} (const char $\ast$sockpath)
\begin{DoxyCompactList}\small\item\em connect to a domain socket. \end{DoxyCompactList}\item 
void {\bf upk\_\-callback\_\-stack\_\-push} ({\bf upk\_\-conn\_\-handle\_\-t} $\ast$handle, {\bf upk\_\-net\_\-cb\_\-stk\_\-t} $\ast$state)
\begin{DoxyCompactList}\small\item\em push a callback-\/stack state element onto the callback stack for a handle. \end{DoxyCompactList}\item 
void {\bf upk\_\-callback\_\-stack\_\-pop} ({\bf upk\_\-conn\_\-handle\_\-t} $\ast$handle)
\begin{DoxyCompactList}\small\item\em pop the top element off the callback-\/stack for a handle. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$$\ast$ Copyright (c) 2011 Yahoo! Inc. All rights reserved. Licensed under the Apache License, Version 2.0 (the \char`\"{}License\char`\"{}); you may not use this file except in compliance with the License. You may obtain a copy of the License at {\tt http://www.apache.org/licenses/LICENSE-\/2.0} Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \char`\"{}AS IS\char`\"{} BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. See accompanying LICENSE file.

The networking code shared by controller and clients 